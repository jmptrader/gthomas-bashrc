#!/bin/sh
echo "Checking state"
if [ x"$1" = x-k ] || ! timeout 3 ls ~/mnt/*/* >/dev/null; then
    echo 'Unmounting'
    sudo umount -lf ~/mnt/*/*
    sudo killall -9 /sbin/mount.cifs
    echo 'Unmounted'
fi
mnt=$(mount)
for nm in ~/mnt/p520/* ~/mnt/brn-dev-lnx/* ~/mnt/unots2/* ~/mnt/vPCS/* ~/mnt/webdb3/*; do
    if [ $(echo "$mnt" | grep $nm | grep -v autofs | wc -l) -ge 1 ]; then
        echo "$nm ok."
    else
        echo "mounting $nm"
        mount $nm
    fi
done
wait
